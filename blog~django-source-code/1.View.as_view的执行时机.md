## 问题
   View.as_view 函数的调用时机是怎样的、通常在 urls.py 中可以看到类似如下的代码
   ```python
   from django.urls import path
   from .views import HelloView
   
   
   urlpatterns = [
       path('', HelloView.as_view()),
   ]
   
   ```

   ---

## 结论
   View.as_view **只在加载路由时执行一次**，就也是可以理解成在启动时执行一次，这一次执行返回的结果用来处理所有的 http 请求

   ---

## 源码分析
   **1、** View.as_view 的关键部分如下
   ```python
   class View(object):
       @classonlymethod
       def as_view(cls, **initkwargs):
           """
           1、由 as_view 的定义可以知道，它可以接收关键字参数
           2、
           Main entry point for a request-response process.
           """
           # 省略了许多非主要的逻辑
           def view(request, *args, **kwargs):

               noter.debug("inner view function been called")

               # 创建出 View 的一个实例，并命名叫 self
               self = cls(**initkwargs)
   
               # 如果 self 有 ‘get’ 但是没有 'head' 那么把 head 设置为 get 相同的值
               if hasattr(self, 'get') and not hasattr(self, 'head'):
                   self.head = self.get
   
               #
               self.setup(request, *args, **kwargs)
               # view 的返回值直接就是 dispatch 执行后的返回值
               return self.dispatch(request, *args, **kwargs)
   
           return view
   ```

   ---

## 调度输出
   ```bash
   python3 manage.py runserver 127.0.0.1:8080
   
   2020-01-09 03:26:51,135 - INFO - django.utils.autoreload - 598 line - Watching for file changes with StatReloader
   Performing system checks...
   2020-01-09 03:26:51,148 - DEBUG - django.notes.View.as_view - 83 line - initkwargs is {'pattern_name': 'admin:auth_group_change'}
   2020-01-09 03:26:51,148 - DEBUG - django.notes.View.as_view - 83 line - initkwargs is {'pattern_name': 'admin:auth_group_change'}
   2020-01-09 03:26:51,148 - INFO - django.notes.View.as_view - 99 line - all keys are valid
   2020-01-09 03:26:51,148 - INFO - django.notes.View.as_view - 99 line - all keys are valid
   2020-01-09 03:26:51,149 - DEBUG - django.notes.View.as_view - 83 line - initkwargs is {'pattern_name': 'admin:auth_user_change'}
   2020-01-09 03:26:51,149 - DEBUG - django.notes.View.as_view - 83 line - initkwargs is {'pattern_name': 'admin:auth_user_change'}
   2020-01-09 03:26:51,149 - INFO - django.notes.View.as_view - 99 line - all keys are valid
   2020-01-09 03:26:51,149 - INFO - django.notes.View.as_view - 99 line - all keys are valid
   2020-01-09 03:26:51,152 - DEBUG - django.notes.View.as_view - 83 line - initkwargs is {}
   2020-01-09 03:26:51,152 - DEBUG - django.notes.View.as_view - 83 line - initkwargs is {}
   2020-01-09 03:26:51,152 - INFO - django.notes.View.as_view - 99 line - all keys are valid
   2020-01-09 03:26:51,152 - INFO - django.notes.View.as_view - 99 line - all keys are valid
   System check identified no issues (0 silenced).
   
   You have 17 unapplied migration(s). Your project may not work properly until you apply the migrations for app(s): admin, auth, contenttypes,    sessions.
   Run 'python manage.py migrate' to apply them.
   
   January 09, 2020 - 03:26:51
   Django version 3.0, using settings 'debugjang.settings'
   Starting development server at http://127.0.0.1:8080/
   Quit the server with CONTROL-C.
   ```
   可以看到所有的 as_view 执行完成之后，才启动的监听 `Starting development server at http://127.0.0.1:8080/` 
   当访问 class-base view 时可以看到如下日志
   ```bash
    Starting development server at http://127.0.0.1:8080/
    Quit the server with CONTROL-C.
    # 上面两行，是接着上面日志内容的
2020-01-09 05:12:09,992 - DEBUG - django.notes.View.as_view.view - 103 line - inner view function been called arsg is () kwargs is {} cls is <class 'apps.foo.views.HelloView'>
2020-01-09 05:12:09,992 - DEBUG - django.notes.View.as_view.view - 103 line - inner view function been called arsg is () kwargs is {} cls is <class 'apps.foo.views.HelloView'>
2020-01-09 05:12:09,993 - DEBUG - django.notes.View.__init__ - 66 line - kwargs is {}
2020-01-09 05:12:09,993 - DEBUG - django.notes.View.__init__ - 66 line - kwargs is {}
2020-01-09 05:12:09,995 - INFO - django.server - 157 line - "GET /foo/ HTTP/1.1" 200 18
   ```
   