## 背景
最近在看一个 dns 库，它里面有一个需求就是要把一个整数(小于 64) 转换成字节码，它的写法是这样的。
```python
In [1]: bytes([3])                                                                                                             
Out[1]: b'\x03'
```

![sqlpy](static/2020-26/sqlpy-struct.jpg)

---

## 我的写法
如果这个让我来写，我会这样写(事实上我也确实没有想到它这种写法)。
```python
In [1]: import struct                                                                                                          

In [2]: struct.pack("<B",3)                                                                                                    
Out[2]: b'\x03'
```

google-adsense

---


## 两种写法的比较
前者直接使用了系统类型一行代码解决，后者使用标准库两行代码解决，哪个在性能上更加优秀呢，那跑个分吧。
```python
import struct
import time


def using_bytes():
    result = []
    for i in range(64):
        result.append(bytes([i])) 
    
    return result


def using_struct():
    result = []
    for i in range(64):
        result.append(struct.pack('<B',i))
    
    return result


def main():
    bytes_start_at = time.time()
    for i in range(1000):
        using_struct()
    bytes_end_at = time.time()

    print(f"bytes cost  {bytes_end_at - bytes_start_at}")



    struct_start_at = time.time()
    for i in range(1000):
        using_struct()
    struct_end_at = time.time()
    print(f"struct cost {struct_end_at - struct_start_at}")


if __name__ == "__main__":

    main()

```

运行效果。

```bash
python3 main.py 
bytes cost  0.011537790298461914
struct cost 0.010931015014648438
```

哈哈哈，它的代码比我的短，但是没我的效率高。

---


